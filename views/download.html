<div class="main-content">
    <div class="main-content-inner">
        <div class="page-content">
            <table id="table">
                <caption>Excel Download</caption>
                <thead>
                    <tr>
                        <th>과목명</th>
                        <th>도분설</th>
                        <th>캡디</th>
                        <th>인공지능</th>
                        <th>데이터 베이스</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <th>월 수</th>
                        <td>Text</td>
                        <td>Text</td>
                        <td rowspan="2">Text</td>
                    </tr>
                    <tr>
                        <th>sample</th>
                        <td>Text</td>
                        <td>Text</td>
                        <td>아 인생</td>
                    </tr>
                    <tr>
                        <th>sample</th>
                        <td>Text</td>
                        <td>Text</td>
                        <td>Text</td>
                        <td>좃댓다</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <button type="button" onclick="fnExcelReport('table','title');">Excel Download</button>
    </div>
    </div>
    <style>
        table {
            width: 100%;
        }
        table, th, td {
            border: 1px solid;
        }
    </style>


<script>
    function fnExcelReport(id, title) {
        var tab_text = '<html xmlns:x="urn:schemas-microsoft-com:office:excel">';
        tab_text = tab_text + '<head><meta http-equiv="content-type" content="application/vnd.ms-excel; charset=UTF-8">';
        tab_text = tab_text + '<xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet>'
        tab_text = tab_text + '<x:Name>Test Sheet</x:Name>';
        tab_text = tab_text + '<x:WorksheetOptions><x:Panes></x:Panes></x:WorksheetOptions></x:ExcelWorksheet>';
        tab_text = tab_text + '</x:ExcelWorksheets></x:ExcelWorkbook></xml></head><body>';
        tab_text = tab_text + "<table border='1px'>";
        var exportTable = $('#' + id).clone();
        exportTable.find('input').each(function (index, elem) { 
            $(elem).remove();
        });
        tab_text = tab_text + exportTable.html();
        tab_text = tab_text + '</table></body></html>';
        var data_type = 'data:application/vnd.ms-excel';
        var ua = window.navigator.userAgent;
        var msie = ua.indexOf("MSIE ");
        var fileName = title + '.xls';
        //Explorer 환경에서 다운로드
        if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./)) {
            if (window.navigator.msSaveBlob) {
                var blob = new Blob([tab_text], {
                    type: "application/csv;charset=utf-8;"
                });
                navigator.msSaveBlob(blob, fileName);
            }
        } 
        else {
            var blob2 = new Blob([tab_text], {
                type: "application/csv;charset=utf-8;"
            });
            var filename = fileName;
            var elem = window.document.createElement('a');
            elem.href = window.URL.createObjectURL(blob2);
            elem.download = filename;
            document.body.appendChild(elem);
            elem.click();
            document.body.removeChild(elem);
        }
    }
</script>
  <link rel="stylesheet" href="./jquery-ui-1.12.1/jquery-ui.min.css">
  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="./jquery-ui-1.12.1/jquery-ui.min.js"></script>
