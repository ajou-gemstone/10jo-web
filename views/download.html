<div class="main-content">
    <div class="main-content-inner">
        <div class="page-content">
            <table id="table">
                <caption>2020-1 교과목</caption>
                <thead>
                    <tr>
                        <th>과목명</th>
                        <th>수강번호</th>
                        <th>교수명</th>
                        <th>강의시간</th>
                        <th>강의실</th>
                    </tr>
                </thead>
                <tbody id = lectureTbody>
                </tbody>
            </table>
        </div>
        <button type="button" onclick="fnExcelReport('table','title');">엑셀로 다운로드</button>
    </div>
    </div>
    <style>
        table {
            width: 100%;
        }
        table, th, td {
            border: 1px solid;
        }
    </style>


<script>
    function fnExcelReport(id, title) {
        var tab_text = '<html xmlns:x="urn:schemas-microsoft-com:office:excel">';
        tab_text = tab_text + '<head><meta http-equiv="content-type" content="application/vnd.ms-excel; charset=UTF-8">';
        tab_text = tab_text + '<xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet>'
        tab_text = tab_text + '<x:Name>Test Sheet</x:Name>';
        tab_text = tab_text + '<x:WorksheetOptions><x:Panes></x:Panes></x:WorksheetOptions></x:ExcelWorksheet>';
        tab_text = tab_text + '</x:ExcelWorksheets></x:ExcelWorkbook></xml></head><body>';
        tab_text = tab_text + "<table border='1px'>";
        var exportTable = $('#' + id).clone();
        exportTable.find('input').each(function (index, elem) { 
            $(elem).remove();
        });
        tab_text = tab_text + exportTable.html();
        tab_text = tab_text + '</table></body></html>';
        var data_type = 'data:application/vnd.ms-excel';
        var ua = window.navigator.userAgent;
        var msie = ua.indexOf("MSIE ");
        var fileName = title + '.xls';
        //Explorer 환경에서 다운로드
        if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./)) {
            if (window.navigator.msSaveBlob) {
                var blob = new Blob([tab_text], {
                    type: "application/csv;charset=utf-8;"
                });
                navigator.msSaveBlob(blob, fileName);
            }
        } 
        else {
            var blob2 = new Blob([tab_text], {
                type: "application/csv;charset=utf-8;"
            });
            var filename = fileName;
            var elem = window.document.createElement('a');
            elem.href = window.URL.createObjectURL(blob2);
            elem.download = filename;
            document.body.appendChild(elem);
            elem.click();
            document.body.removeChild(elem);
        }
    }
</script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <link rel="stylesheet" href="./jquery-ui-1.12.1/jquery-ui.min.css">
  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="./jquery-ui-1.12.1/jquery-ui.min.js"></script>
<script>
    var result = new Array();

    (async function dataPrint() {
      await axios.get('http://localhost:5010/lecture/list').then(res => { // 불러온 값을 Console에 뿌려줍니다.
        result = res.data;
      });
      for (var i = 0; i < result.length; i++) {
        var rowItem = "<tr>"  
        rowItem += "<td>"
        rowItem += "</td>"
        rowItem += "</tr>"
        $('#lectureTbody').append(rowItem)
      }
      $(document).ready(function() {
        $('#table').DataTable();
      });
    })(2);

</script>


